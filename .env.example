# myInvestments Environment Variables
# Copy to .env.local (or apps/frontend/.env.local) and fill in values.
# NEVER commit .env.local or any file with real credentials.

# =============================================================================
# MongoDB
# =============================================================================
# Connection string. For local Docker: mongodb://localhost:27017/myinvestments
# For Atlas: mongodb+srv://user:password@cluster.mongodb.net/myinvestments
MONGODB_URI=mongodb://localhost:27017/myinvestments

# Database name (default: myinvestments)
# MONGODB_DB=myinvestments

# --- MONGODB_URI_B64 (when plain MONGODB_URI is problematic) ---
# Use base64 when the URI contains special characters (# ! $ & etc.) that get
# mangled by your host, CI, or deployment (e.g. Atlas password with symbols).
# If MONGODB_URI_B64 is set, it takes precedence over MONGODB_URI.
#
# How to generate:
#   1. Take your raw URI (no newline, no extra spaces). Example:
#        mongodb+srv://myuser:P%40ss%23word@cluster0.xxxxx.mongodb.net/myinvestments?retryWrites=true
#   2. Encode it as base64 (no newline in output):
#
#      On macOS/Linux:
#        echo -n "mongodb+srv://user:password@host/dbname" | base64
#
#      Or in Node:
#        node -e "console.log(Buffer.from('mongodb+srv://user:pass@host/db', 'utf8').toString('base64'))"
#
#   3. Put the result in .env.local:
#        MONGODB_URI_B64=bW9uZ29kYisrc3J2Oi8vdXNlcjpwYXNzQGhvc3QvZGJuYW1l
#
# Leave MONGODB_URI unset or comment it out when using MONGODB_URI_B64.
# MONGODB_URI_B64=

# Data cleanup (optional) – purge when nearing storage limit
# MONGODB_STORAGE_LIMIT_MB=512
# MONGODB_PURGE_THRESHOLD=0.75

# =============================================================================
# Auth (Auth.js v5 – Sign in with X)
# =============================================================================
# Generate a secret: npx auth secret
AUTH_SECRET=your_auth_secret_here
# NEXTAUTH_SECRET=  # alternative name; AUTH_SECRET takes precedence

# App URL. Production: set to your public URL (e.g. https://app.example.com)
NEXTAUTH_URL=http://localhost:3000
# AUTH_URL=  # alternative; NEXTAUTH_URL is preferred

# Debug: set AUTH_DEBUG=true and restart; logs [auth] to console (local only)
# AUTH_DEBUG=true

# Local dev only: SKIP_AUTH=true bypasses X sign-in
# SKIP_AUTH=true

# One-time bootstrap key for sign-in when X OAuth fails. After first sign-in,
# create keys in Settings → Access keys and remove this.
# ACCESS_KEY_SEED=your_one_time_bootstrap_key

# =============================================================================
# X (Twitter) OAuth – Sign in with X
# =============================================================================
# From https://developer.x.com/ → your app → User authentication → OAuth 2.0
# Add callback URLs in the portal (User authentication → OAuth 2.0):
#   Local:      http://localhost:3000/api/auth/callback/twitter
#   Production: https://your-app.example.com/api/auth/callback/twitter
X_CLIENT_ID=your_x_client_id
X_CLIENT_SECRET=your_x_client_secret

# Optional: restrict sign-in to these X usernames (comma-separated). Empty = allow all.
# ALLOWED_X_USERNAMES=

# =============================================================================
# X (Twitter) posting – Alerts, test (pnpm run test:x-post-cli)
# =============================================================================
# Same app as OAuth; different keys. In portal → Keys and tokens:
#   Bearer token (read-only) → X_BEARER_TOKEN
#   Consumer (app) → X_CONSUMER_KEY, X_CONSUMER_SECRET
#   User (for posting) → X_ACCESS_TOKEN, X_ACCESS_TOKEN_SECRET (Read and write)
X_BEARER_TOKEN=
X_CONSUMER_KEY=
X_CONSUMER_SECRET=
X_ACCESS_TOKEN=
X_ACCESS_TOKEN_SECRET=
# Optional: username to post as (default: atxbogart)
# X_POST_AS_USERNAME=AtxBogart

# =============================================================================
# Scheduler & cron
# =============================================================================
# Next.js (local): leave AGENDA_MASTER unset → slave (schedules only, no job execution).
# Remote/prod worker: set AGENDA_MASTER=true → master (only process that runs jobs).
# AGENDA_MASTER=true

# Optional: JOB_RUNNER=false disables starting the scheduler (e.g. web-only process).
# JOB_RUNNER=false

# Optional: if set, POST /api/cron/* and /api/internal/run-task require
#   Authorization: Bearer <CRON_SECRET>
# CRON_SECRET=shared_secret

# Optional: used in scheduler/alert links (e.g. "View Dashboard"). Set in prod.
# NEXT_PUBLIC_APP_URL=https://your-app.example.com

# =============================================================================
# xAI Grok (Smart Grok Chat)
# =============================================================================
XAI_API_KEY=your_xai_api_key_here
# Optional: model name (default: grok-4)
# XAI_MODEL=grok-4

# =============================================================================
# Web search (Grok chat – weather, news, earnings)
# =============================================================================
# SerpAPI key from https://serpapi.com/ . Either key name works.
WEB_SEARCH_API_KEY=your_serpapi_key_here
# SERPAPI_API_KEY=  # alternative to WEB_SEARCH_API_KEY

# =============================================================================
# Rate limiting (optional)
# =============================================================================
# When set, API rate limits (chat, import, cron) use Upstash Redis instead of in-memory.
# From https://console.upstash.com/ → create Redis → copy REST URL and token.
# UPSTASH_REDIS_REST_URL=https://xxx.upstash.io
# UPSTASH_REDIS_REST_TOKEN=your_token

# =============================================================================
# Other
# =============================================================================
# Optional: CORS. When set, API responses include Access-Control-Allow-Origin.
# CORS_ORIGIN=https://your-frontend.example.com

# Optional: Slack webhook for CI/build status or alerts (e.g. GitHub Actions secret).
# SLACK_WEBHOOK_URL=https://hooks.slack.com/services/xxx

# Slack bot (slash command /invest – "show TSLA covered calls", "roll 450 to Feb").
# From Slack app → Basic Information → Signing Secret. Required for Events API + slash.
# SLACK_SIGNING_SECRET=your_signing_secret
# From Slack app → OAuth & Permissions → Bot User OAuth Token (for future chat.postMessage etc.).
# SLACK_BOT_TOKEN=xoxb-...

# Optional: set to false to disable NL order parse/confirm and Slack bot (e.g. in CI). Default: enabled.
# NL_ORDER_ENABLED=true

# Optional: Web Push (VAPID) for push notifications.
# VAPID_PUBLIC_KEY=
# VAPID_PRIVATE_KEY=
# VAPID_SUBJECT=mailto:admin@myinvestments.app
