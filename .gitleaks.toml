# Gitleaks configuration
# https://github.com/gitleaks/gitleaks

title = "myInvestments Gitleaks Config"

[extend]
# Use the default gitleaks rules as a base
useDefault = true

# Global allowlist for paths
[allowlist]
paths = [
  '''node_modules''',
  '''\.git''',
  '''package-lock\.json''',
  '''\.next''',
  '''dist''',
  '''build''',
  '''coverage''',
  '''\.env\.example''',
  '''\.env\.sample''',
  '''\.env\.template''',
  '''src/lib/__tests__/env\.test\.ts''',
  '''scripts/seed-local-db\.ts''',
]

# Additional rules for common secrets in this project
[[rules]]
id = "polygon-api-key"
description = "Polygon.io API Key"
regex = '''POLYGON_API_KEY\s*=\s*["\']?[A-Za-z0-9_]{20,}["\']?'''
tags = ["api", "polygon"]

[[rules]]
id = "mongodb-connection-string"
description = "MongoDB Connection String with credentials"
regex = '''mongodb(\+srv)?:\/\/[^:]+:[^@]+@[^\s"'\`]+'''
tags = ["database", "mongodb"]

[[rules]]
id = "next-auth-secret"
description = "NextAuth Secret"
regex = '''NEXTAUTH_SECRET\s*=\s*["\']?[A-Za-z0-9+/=]{20,}["\']?'''
tags = ["auth", "nextauth"]

[[rules]]
id = "jwt-secret"
description = "JWT Secret"
regex = '''JWT_SECRET\s*=\s*["\']?[^\s"'\`]{16,}["\']?'''
tags = ["auth", "jwt"]
